<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .users-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .users-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .user-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .user-avatar {
            font-size: 50px;
            margin-bottom: 15px;
        }
        
        .user-rating {
            margin: 10px 0;
        }
        
        .vote-btn {
            background: #35424a;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        .vote-btn:hover {
            background: #e8491d;
        }
        
        .message-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        .message-btn:hover {
            background: #45a049;
        }
        
        .search-box {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            margin-bottom: 20px;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
<header>
    <nav>
        <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="users.html">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
        <a href="games.html">üéÆ –ò–≥—Ä—ã</a>
        <span id="profileLink" style="display: none;"></span>
        <span id="authLinks">
            <a href="login.html">–í—Ö–æ–¥</a>
            <a href="register.html">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
        </span>
    </nav>
</header>

    <main class="users-container">
        <h1>üë• –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h1>
        <input type="text" id="searchInput" class="search-box" placeholder="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...">
        
        <div id="usersList" class="users-grid">
            <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
        </div>
    </main>

    <script src="auth.js"></script>
    <script>
        function loadUsers() {
            if (!auth.isLoggedIn()) {
                window.location.href = 'login.html';
                return;
            }
            
            const usersList = document.getElementById('usersList');
            const allUsers = auth.getAllUsers();
            
            if (allUsers.length === 0) {
                usersList.innerHTML = '<p>–ü–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>';
                return;
            }
            
            usersList.innerHTML = allUsers.map(user => `
                <div class="user-card">
                    <div class="user-avatar">${user.profile.avatar}</div>
                    <h3>${user.username}</h3>
                    <div class="user-rating">
                        <div>‚≠ê ${user.profile.rating}</div>
                        <small>${user.profile.votes} –≥–æ–ª–æ—Å–æ–≤</small>
                    </div>
                    <p>${user.profile.bio}</p>
                    <div>
                        <button class="vote-btn" onclick="voteForUser('${user.id}', 1)">üëç</button>
                        <button class="vote-btn" onclick="voteForUser('${user.id}', -1)">üëé</button>
                        <button class="message-btn" onclick="startChat('${user.id}')">üí¨ –ù–∞–ø–∏—Å–∞—Ç—å</button>
                    </div>
                </div>
            `).join('');
        }
        
        function voteForUser(userId, vote) {
            auth.voteForUser(userId, vote);
            loadUsers(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
        }
        
        function startChat(userId) {
            window.location.href = `messages.html?user=${userId}`;
        }
        
        // –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const userCards = document.querySelectorAll('.user-card');
            
            userCards.forEach(card => {
                const username = card.querySelector('h3').textContent.toLowerCase();
                if (username.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        });
        
        document.addEventListener('DOMContentLoaded', loadUsers);
    </script>
</body>
</html>